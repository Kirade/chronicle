# SwiftData 학습 정리 📚

## 오늘 배운 핵심 개념들

### 1. SwiftData의 3가지 핵심 구성요소

#### 🏗️ Model
```swift
@Model
class Wish {
    var title: String

    init(title: String) {
        self.title = title
    }
}
```
- **역할**: 데이터의 구조를 정의 (도서관의 "책 한 권")
- **`@Model` 매크로**: 일반 클래스를 SwiftData가 관리할 수 있는 모델로 변환
  - `PersistentModel` 프로토콜 자동 구현
  - 변경 추적 기능 추가
  - 고유 식별자 자동 생성

#### 📦 ModelContainer
```swift
// App 레벨에서 설정
.modelContainer(for: Wish.self)
```
- **역할**: 데이터를 저장하는 전체 저장소 (도서관 "건물")
- 앱 전체에서 하나만 생성
- 실제 데이터베이스 파일 관리

#### 👷 ModelContext
```swift
@Environment(\.modelContext) private var modelContext

// 사용 예시
modelContext.insert(Wish(title: "새로운 소원"))
modelContext.delete(wish)
```
- **역할**: 데이터를 조작하는 도구 (도서관의 "사서")
- Container가 자동으로 생성해서 제공
- 데이터 추가, 삭제, 수정 작업 수행

### 2. Swift/SwiftUI 핵심 문법

#### 📌 Property Wrapper
특별한 기능을 추가하는 "포장지" 역할

- **`@State`**: View가 소유하고 관리하는 값
- **`@Environment`**: 상위에서 전달받은 환경 값
- **`@Query`**: SwiftData가 자동으로 채워주는 데이터

#### 🔄 Binding (`$`)
```swift
@State private var title = ""
TextField("Enter text", text: $title)  // $는 "수정 권한"을 전달
```
- `title`: 값 자체
- `$title`: 값을 수정할 수 있는 핸들

#### 🎨 View Modifier
```swift
Text("Hello")
    .font(.title)
    .padding()
    .modelContainer(for: Wish.self)
```
- Extension과 Protocol을 활용한 체이닝 패턴
- 각 modifier는 새로운 View를 반환

#### 🗂️ 앱 구조 계층
```
App (@main)
  └─> Scene (WindowGroup)
      └─> View (ContentView)
          └─> Sub Views
```

### 3. SwiftData 데이터 흐름

```swift
// 1. App에서 Container 설정
@main
struct WishlistApp: App {
    var body: some Scene {
        WindowGroup {
            ContentView()
                .modelContainer(for: Wish.self)  // Container 생성
        }
    }
}

// 2. View에서 Context와 데이터 사용
struct ContentView: View {
    @Environment(\.modelContext) private var modelContext  // Context 가져오기
    @Query private var wishes: [Wish]  // 데이터 자동 조회

    // 3. 데이터 조작
    func addWish() {
        modelContext.insert(Wish(title: "새 소원"))
    }
}
```

### 4. 중요한 개념 구분

#### Attribute vs Macro
- **Attribute** (`@main`, `@State`): 컴파일러에게 특별한 처리 지시
- **Macro** (`@Model`, `@Observable`): 코드 자동 생성 도구

#### Protocol vs Extension
- **Protocol**: "약속" - 구현해야 할 요구사항 정의
- **Extension**: 기존 타입에 새로운 기능 추가

#### KeyPath (`\.`)
```swift
@Environment(\.modelContext)  // EnvironmentValues.modelContext의 축약형
```
특정 속성으로 가는 "경로"를 타입 안전하게 표현

### 5. 설계 철학

#### SwiftUI의 원칙
- **선언적 UI**: "어떻게"가 아닌 "무엇을" 보여줄지 선언
- **단일 진실 공급원**: 데이터는 한 곳에서 관리
- **자동 업데이트**: 데이터 변경 시 UI 자동 갱신

#### Environment 패턴
- 각 View가 필요한 값을 직접 Environment에서 가져옴
- props drilling 방지
- 의존성 명확화

### 다음 학습 주제 추천

1. **Relationships**: 모델 간 관계 설정
2. **Advanced Query**: 정렬, 필터링, Predicate
3. **Migration**: 스키마 변경 시 데이터 마이그레이션
4. **Performance**: 대용량 데이터 처리 최적화

---

오늘 정말 많은 개념을 탐구했네요! 기초부터 차근차근 질문하면서 SwiftData의 핵심을 잘 이해하신 것 같아요. 특히 "왜?"라는 질문을 계속 던지면서 깊이 파고든 점이 인상적이었어요. 다음에도 이런 호기심을 가지고 학습하시면 좋을 것 같아요! 🚀
