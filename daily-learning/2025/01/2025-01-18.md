# Daily Learning: 2025-01-18

## 📚 What I Learned Today
- 분산 시스템을 위한 유일 ID 생성기 설계
    - 유일 ID 를 생성하는 방법중의 하나로 단일 시스템 환경에서 자주 사용되는 Auto Increment 방식이 흔하다. 단일 시스템이 아닌 분산 시스템 환경에서는 이런 방법이 효과적이지 않은데, 대용량의 데이터로 인해 분산이 불가피한 상황이 발생할 수 있기 떄문이다.

    - 다중 마스터 복제
        - 분산 환경이지만 데이터베이스의 auto increment 기능을 활용한 방식이다. 일반적인 사용법과 다르게 ID 가 1씩 증가하지 않고 현재 운영중인 서버의 대수 N 만큼 ID 가 증가하는 방식으로 분산 시스템에서 유일한 ID 를 보장한다.
        - 이 방식은 데이터 센터 여러개에 걸쳐 규모를 늘리기 쉽지 않고, 서버를 추가하거나 삭제할 때 마이그레이션 과정이 쉽지 않다.

    - UUID
        - UUID 생성을 통해 겹치는 UUID 가 1개 나올확률을 50% 까지 올리려면 초당 10억개의 UUID 를 100년동안 만들어야 한다고 한다. 따라서 UUID 를 활용한 분산시스템은 각 시스템에서 UUID 생성기를 직접 사용한다.
        - 각 서버가 ID 의 생성을 책임지기 때문에 서버 규모의 확장과 축소가 쉽고 동기화가 따로 필요 없다. 하지만 ID 가 시간순으로 정렬이 불가하기 때문에 정렬이 필요한 경우 적절하지 않은 대안일 수 있다.

    - 티켓 서버
        - 분산 시스템의 ID 를 발급하는 중앙 집중화된 티켓 서버를 두는 방식이다. 이 방식을 통해 유일성이 보장되는 ID 를 손쉽게 만들 수 있다.
        - 티켓 서버가 장애를 겪는 경우 SPOF 가 된다. 이 문제를 해결하기 위해서 가용성을 늘리면 다시 데이터 동기화와 같은 새로운 문제가 생긴다.

    - 트위터 스노우플레이크
        - ID 를 바로 생성하지 않고 ID 의 구조를 여러 절로 나눈다. HTTP 통신을 위한 패킷의 구조를 나누듯 요구 사항으로 나온 길이에 맞는 ID 를 직접 디자인할 수 있다.
        - 사인비트, 타임스탬프, 데이터센터ID, 서버ID, 일련번호를 포함한다.
        - 타임스탬프는 epoch 를 활용하고 일련번호를 통해 동일한 타임스탬프에 발생할수 있는 동시 요청들에 대한 버퍼를 두도록 한다.
        - 각 섹션별 비트를 조절하여 ID 설계 요구사항에 걸맞는 디자인을 쉽게 설계해낼 수 있다.
